<HTML>
<HEAD>
<title>Address Spaces</title>
</HEAD>

<body>
<H1><CENTER>Address Spaces</center></h1>
<h3><center>the first part of the seventh chapter in our series 
on <i>How to Write an Operating System</i></center></h3>

<hr>

<a name="PDBR"><h2>The Page Directory Base Register (PDBR)</h2></a>

<p>Control Register 3 (CR3) is often referred to as the Page Directory 
Base Register (PDBR).  This 32-bit register contains the physical
address of a page, which should be a Page Directory (if paging is
turned on, and CR3 is set to an invalid or uninitialized page 
directory, the machine will most likely suffer an unrecoverable
fault, since all memory references have just been yanked out
from under it).
</p>

Routines for setting and reading the current value of CR3 follow:

<pre><code>void setCR3(unsigned int pagedir)
{
   asm ("mov %0, %%cr3": :"r" (pagedir));
}

unsigned int getCR3(void)
{
   unsigned int _cr3;

   asm ("mov %%cr3, %0":"=r" (_cr3));
   return _cr3;
}
</code></pre>

<hr>
<!--#include virtual="/include/footer.html" -->
</BODY>
</HTML>

